---
height: "960"
width: "1440"
---

## Task

- **Input**:
  - pre-surgery CT
  - displacement of skull points after surgery
- **Output**:
  - post-surgery face
- **Method**:
  - Mass-Tensor Model

--

## Simulation Task

- **Input**:
  - pre-surgery tetrahedral mesh
  - displacement of skull points
  - material properties
- **Output**:
  - displacement of free points

---

## Mass-Tensor Model

$$
\begin{align*}
  W & = \frac{\lambda}{2} (\mathrm{tr}(E))^{2} + \mu \mathrm{tr}(E^2) \\\\
  E & = \frac{1}{2} ((\nabla{u})^{T} + \nabla{u} + (\nabla{u})^{T} \cdot \nabla{u})
\end{align*}
$$

- $W$ --- strain-energy density for Saint Venant–Kirchhoff model
- $\lambda, \mu$ --- Lamé parameters
- $E$ --- (Lagrangian finite) strain tensor

Based on the linear approximation:

$$
f_i = \frac{\partial}{\partial u_i} \sum_t W_t V_t
\Rightarrow
\mathbf{f} = [\mathbf{K}] \mathbf{u}
$$

--

## Mass-Tensor Model

- suppose: soft tissue near skull sticks to skull

$$
\begin{bmatrix}
  K_{00} & K_{01} \\\\
  K_{10} & K_{11}
\end{bmatrix} \begin{bmatrix}
  u_0 \\\\
  u_1
\end{bmatrix} = \begin{bmatrix}
  f_0 \\\\
  f_1
\end{bmatrix}
$$

- (to be solved) $u_0$ --- displacement of free points
- (known) $u_1$ --- displacement of fixed points (on skull)
- (known) $f_1 = 0$ --- nodal force on free points

$$
K_{11} u_1 = - K_{10} u_0
$$

--

## Solver

$$
K_{11} u_1 = - K_{10} u_0
$$
