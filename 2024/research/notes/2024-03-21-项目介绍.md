# é¡¹ç›®ä»‹ç»

åŸºäºç‰©ç†æ¨¡æ‹Ÿçš„æ•´å½¢æ‰‹æœ¯æœ¯åå¤–å½¢é¢„æµ‹

## é—®é¢˜

- **è¾“å…¥**: æœ¯å‰ CT + æ‰‹æœ¯æ–¹æ¡ˆ
- **è¾“å‡º**: æœ¯åè¡¨é¢
- **æ•°æ®**: å¤šç»„æœ¯å‰å CT (æœªæ ‡æ³¨ landmarks)

## è´¡çŒ®ç‚¹

æš‚æ— 

## æ–¹æ³•æµç¨‹

ğŸŸ¢ DONE ğŸ”µ Partially done, can move on ğŸŸ¡ DOING ğŸ”´ TODO

### ğŸ”µ Registration

- **è¾“å…¥**: æœ¯å‰, æœ¯å CT
- **è¾“å‡º**: æœ¯å‰ååŒæ‹“æ‰‘, æ— ç©¿æ¨¡çš„ skull mesh & face mesh

```mermaid
flowchart
    subgraph Template
        S00[00.Mesh]
        S01[01.Mesh]
        S02[02.Mesh]
        S03[[03.Mesh]]
        S03L[[03.Mesh + Landmarks]]
    end
    subgraph Target
        T00[00.CT]
        T01[01.Mesh]
        T02([02.Mesh])
        T02L([02.Mesh + Landmarks])
        A{{ğŸŸ¢ Align}}
        T03L[[03.Mesh + Landmarks]]
        R{{ğŸ”µ Register}}
        T04[[04.Mesh]]
    end
    S00 --> |ğŸŸ¢ Preprocess| S01
    S01 --> |ğŸŸ¢ Edit| S02
    S02 --> |ğŸŸ¢ MeshFix| S03
    S03 --> |Annotate| S03L
    T00 --> |ğŸŸ¢ CT2Mesh| T01
    T01 --> |ğŸŸ¢ Simplify| T02
    T02 --> |Annotate| T02L
    S03L --> |Source| A
    T02L --> |Target| A
    A --> T03L
    T03L --> |Source| R
    T02L --> |Target| R
    R --> T04
```

#### åœ¨ [^1] åŸºç¡€ä¸Šçš„æ”¹åŠ¨

[^1]: Amberg, Brian, Sami Romdhani, and Thomas Vetter. 2007. â€œOptimal Step Nonrigid ICP Algorithms for Surface Registration.â€ In _2007 IEEE Conference on Computer Vision and Pattern Recognition_, 1â€“8. Minneapolis, MN, USA: IEEE. [https://doi.org/10.1109/CVPR.2007.383165](https://doi.org/10.1109/CVPR.2007.383165).

- åˆ†åŒº, åˆ†æ­¥æŒ‡å®šå‚æ•°
- å‚æ•°æœç´¢ä»¥é¿å…ç©¿æ¨¡ (æ”¶æ•ˆç”šå¾®)
- å¯»æ‰¾æœ€è¿‘é‚»å¯¹åº”æ—¶è€ƒè™‘æ³•å‘

### ğŸŸ¡ Simulation

- **è¾“å…¥**: pre-surgery face mesh, pre-surgery skull mesh, post-surgery skull mesh
- **è¾“å‡º**: post-surgery face mesh

1. ğŸŸ¢ ä½¿ç”¨ [TetGen](https://wias-berlin.de/software/index.jsp?id=TetGen) åœ¨éª¨éª¼ä¸è¡¨é¢ä¹‹é—´å¡«å……å››é¢ä½“æ¨¡æ‹Ÿè½¯ç»„ç»‡
2. ğŸŸ¢ ä½¿ç”¨ [^2] æå‡ºçš„ MTM (Mass-Tensor Model) å°†é—®é¢˜è½¬åŒ–ä¸ºçº¿æ€§ç³»ç»Ÿ
3. ğŸŸ¡ ä½¿ç”¨ [MINRES](https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.minres.html) æ±‚è§£

[^2]: Cotin, StÃ©phane, HervÃ© Delingette, and Nicholas Ayache. 2000. â€œA Hybrid Elastic Model Allowing Real-Time Cutting, Deformations and Force-Feedback for Surgery Training and Simulation.â€ _Visual Computer_ 16 (8): 437â€“52.

#### çº¿æ€§ç³»ç»Ÿ

$$
\begin{bmatrix}
  K_{00} & K_{01} \\
  K_{10} & K_{11}
\end{bmatrix} \begin{bmatrix}
  \delta_0 \\
  \delta_1
\end{bmatrix} = \begin{bmatrix}
  f_0 \\
  f_1
\end{bmatrix}
$$

å…¶ä¸­:

- å·²çŸ¥ $K$ --- å¸¸ç¨€ç–çŸ©é˜µ, ä¸ä¿è¯æ­£å®šæ€§ä¸å¯é€†æ€§
- å·²çŸ¥ $\delta_0$ --- ç´§é‚»éª¨éª¼çš„é¡¶ç‚¹ä½ç§»
- æ±‚è§£ $\delta_1$ --- è‡ªç”±é¡¶ç‚¹çš„ä½ç§»
- æœªçŸ¥ $f_0$ --- ç´§é‚»éª¨éª¼çš„é¡¶ç‚¹æ‰€å—å¤–åŠ›, å³éª¨éª¼å¯¹è½¯ç»„ç»‡çš„åŠ›
- å·²çŸ¥ $f_1 = \mathbf{0}$ --- è‡ªç”±é¡¶ç‚¹æ‰€å—çš„å¤–åŠ›, å¹³è¡¡çŠ¶æ€ä¸‹ä¸º 0

å¯å¾—:

$$
K_{11} \delta_1 = - K_{10} \delta_0
$$

### ğŸ”´ è¯„ä¼°

1. ğŸŸ¡ è®¡ç®—é€é¡¶ç‚¹è¯¯å·®å¹¶å¯è§†åŒ–
